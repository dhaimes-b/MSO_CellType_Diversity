grp2m = SummaryStats[2,3],
grp2sd = SummaryStats[2,4],
grp2n=SummaryStats[2,2],
es.type = "g")
test1.2 <- test$es
test <- esc_mean_sd(grp1m = SummaryStats[1,3],
grp1sd = SummaryStats[1,4],
grp1n=SummaryStats[1,2],
grp2m = SummaryStats[3,3],
grp2sd = SummaryStats[3,4],
grp2n=SummaryStats[3,2],
es.type = "g")
test1.3 <- test$es
test <- esc_mean_sd(grp1m = SummaryStats[2,3],
grp1sd = SummaryStats[2,4],
grp1n=SummaryStats[2,2],
grp2m = SummaryStats[3,3],
grp2sd = SummaryStats[3,4],
grp2n=SummaryStats[3,2],
es.type = "g")
test2.3 <- test$es
output <- as.data.frame(c(SummaryStats,test1.2,test1.3,test2.3))
#summary(output)
return(SummaryStats)
}
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Peak.input.Resistance)
RunEffectSize <- function(df, col_name, var_name) {
col_name <- enquo(col_name)
var_name <- enquo(var_name)
SummaryStats <- df %>%
filter(!is.na(!!var_name)) %>%
group_by(!!col_name) %>%
summarise(n=n(),
mean = mean(!!var_name),
sd = sd(!!var_name),
sem = se(!!var_name))
test <- esc_mean_sd(grp1m = SummaryStats[1,3],
grp1sd = SummaryStats[1,4],
grp1n=SummaryStats[1,2],
grp2m = SummaryStats[2,3],
grp2sd = SummaryStats[2,4],
grp2n=SummaryStats[2,2],
es.type = "g")
test1.2 <- test$es
test <- esc_mean_sd(grp1m = SummaryStats[1,3],
grp1sd = SummaryStats[1,4],
grp1n=SummaryStats[1,2],
grp2m = SummaryStats[3,3],
grp2sd = SummaryStats[3,4],
grp2n=SummaryStats[3,2],
es.type = "g")
test1.3 <- test$es
test <- esc_mean_sd(grp1m = SummaryStats[2,3],
grp1sd = SummaryStats[2,4],
grp1n=SummaryStats[2,2],
grp2m = SummaryStats[3,3],
grp2sd = SummaryStats[3,4],
grp2n=SummaryStats[3,2],
es.type = "g")
test2.3 <- test$es
output <- as.data.frame(c(SummaryStats))#,test1.2,test1.3,test2.3))
#summary(output)
return(SummaryStats)
}
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Peak.input.Resistance)
RunEffectSize <- function(df, col_name, var_name) {
col_name <- enquo(col_name)
var_name <- enquo(var_name)
SummaryStats <- df %>%
filter(!is.na(!!var_name)) %>%
group_by(!!col_name) %>%
summarise(n=n(),
mean = mean(!!var_name),
sd = sd(!!var_name),
sem = se(!!var_name))
test <- esc_mean_sd(grp1m = SummaryStats[1,3],
grp1sd = SummaryStats[1,4],
grp1n=SummaryStats[1,2],
grp2m = SummaryStats[2,3],
grp2sd = SummaryStats[2,4],
grp2n=SummaryStats[2,2],
es.type = "g")
test1.2 <- test$es
test <- esc_mean_sd(grp1m = SummaryStats[1,3],
grp1sd = SummaryStats[1,4],
grp1n=SummaryStats[1,2],
grp2m = SummaryStats[3,3],
grp2sd = SummaryStats[3,4],
grp2n=SummaryStats[3,2],
es.type = "g")
test1.3 <- test$es
test <- esc_mean_sd(grp1m = SummaryStats[2,3],
grp1sd = SummaryStats[2,4],
grp1n=SummaryStats[2,2],
grp2m = SummaryStats[3,3],
grp2sd = SummaryStats[3,4],
grp2n=SummaryStats[3,2],
es.type = "g")
test2.3 <- test$es
output <- as.data.frame(c(SummaryStats,test1.2,test1.3,test2.3))
#summary(output)
return(output)
}
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Peak.input.Resistance)
compare_means(Threshold.Relative.Rest ~ Subtype_Precise,
data = df_Ephys_Clean, method="kruskal.test")
compare_means(Peak.input.Resistance ~ Subtype_Precise,
data = df_Ephys_Clean, comparisons = pairs)
compare_means(EPSP.halfwidth ~ Subtype_Precise,
data = df_Ephys_Clean, comparisons = pairs)
df_Ephys_Clean %>%
filter(Age > 0) %>%
ggplot(aes(x= Age,
y= Spike.Amp..Relative.Thresh.,
color = Subtype_Precise)) +
geom_jitter()+
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
theme_pubr()+
ylab("Spike Amplitude (Rel. Threshold [mV])")+
xlab("Postnatal Age (Days)") +
xlim(0,80)+
theme(legend.position="none")
p2 <- df_Ephys_Clean %>%
filter(Age > 28) %>%
filter(Age > 0) %>%
ggplot(aes(x= Age,
y= Spike.Amp..Relative.Rest,
color = Subtype_Precise)) +
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
geom_point()+
theme_pubr()
grid.arrange(p1,p2)
df_Ephys_Clean %>%
filter(Age > 28) %>%
filter(Age > 0) %>%
ggplot(aes(x= Age,
y= Spike.Amp..Relative.Rest,
color = Subtype_Precise)) +
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
geom_point()+
theme_pubr()
df_Ephys_Clean %>%
filter(Age > 0) %>%
ggplot(aes(x= Age,
y= DV_NLG,
color = Subtype_Precise)) +
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
scale_y_continuous(trans = "reverse")+
geom_jitter()+
theme_pubr()+
ylab("Tonotopic Position")+
xlab("Postnatal Age (Days)") +
xlim(0,80)+
theme(legend.position="none")
df_Ephys_Clean %>%
filter(Age > 0) %>%
ggplot(aes(x= Age,
#y= ,
fill = Subtype_Precise)) +
geom_histogram(binwidth = 10, stat = ..percent..)+
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
theme_pubr()+
#  ylab("Spike Amplitude (Rel. Threshold [mV])")+
xlab("Postnatal Age (Days)") +
xlim(0,80)+
theme(legend.position="none")
df_Ephys_Clean %>%
filter(Age > 0) %>%
ggplot(aes(x= Age,
#y= ,
fill = Subtype_Precise)) +
geom_histogram(binwidth = 10, stat = ..percent..)+
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
theme_pubr()+
#  ylab("Spike Amplitude (Rel. Threshold [mV])")+
xlab("Postnatal Age (Days)") +
xlim(0,80)+
theme(legend.position="none")
df_Ephys_Clean %>%
filter(Age > 0) %>%
ggplot(aes(x= Age,
y= Threshold.Relative.Rest,
color = Subtype_Precise)) +
geom_jitter()+
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
theme_pubr()+
# ylab("Spike Amplitude (Rel. Threshold [mV])")+
xlab("Postnatal Age (Days)") +
xlim(0,80)+
theme(legend.position="none")
df_Ephys_Clean %>%
filter(Age > 0) %>%
ggplot(aes(x= Age,
y= Absolute.Threshold,
color = Subtype_Precise)) +
geom_jitter()+
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
theme_pubr()+
# ylab("Spike Amplitude (Rel. Threshold [mV])")+
xlab("Postnatal Age (Days)") +
xlim(0,80)+
theme(legend.position="none")
df_Ephys_Clean %>%
filter(Age > 0) %>%
ggplot(aes(x= Age,
y= Threshold.Relative.Rest,
color = Subtype_Precise)) +
geom_jitter()+
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
theme_pubr()+
# ylab("Spike Amplitude (Rel. Threshold [mV])")+
xlab("Postnatal Age (Days)") +
xlim(0,80)+
theme(legend.position="none")
df_Ephys_Clean %>%
filter(Age > 0) %>%
ggplot(aes(x= Age,
y= DV_NLG,
color = Subtype_Precise)) +
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
scale_y_continuous(trans = "reverse")+
geom_jitter()+
theme_pubr()+
ylab("Tonotopic Position")+
xlab("Postnatal Age (Days)") +
xlim(0,80)+
theme(legend.position="none")
ggsave("C:/Users/dhaim/Box/MSO Cell Type - Brian Data/Tonotopy_AgeDistr.eps", width = 4.5, height = 3, unit = "in")
p1 <- df_Ephys_Clean %>%
filter(Age < 28) %>%
filter(Age > 0) %>%
ggplot(aes(x= Age,
y= Spike.Amp..Relative.Rest)) +
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
geom_point()+
theme_pubr()+
facet_wrap(~Subtype_Precise + (Age > 28))
p2 <- df_Ephys_Clean %>%
filter(Age > 28) %>%
filter(Age > 0) %>%
ggplot(aes(x= Age,
y= Spike.Amp..Relative.Rest,
color = Subtype_Precise)) +
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
geom_point()+
theme_pubr()
grid.arrange(p1,p2)
df_Ephys_Clean %>%
filter(Age > 0) %>%
ggplot(aes(x= Age,
y= Spike.Amp..Relative.Thresh.,
color = Subtype_Precise)) +
geom_jitter()+
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
theme_pubr()+
ylab("Spike Amplitude (Rel. Threshold [mV])")+
xlab("Postnatal Age (Days)") +
xlim(0,80)+
theme(legend.position="none")
df_Subtype_All %>%
ggplot(aes(x=Subtype_Expand,
y=log(df_Subtype_All$Peak.input.Resistance),
color = Subtype_Expand)) +
geom_quasirandom(varwidth = T,dodge.width = .5)+
scale_color_manual(values = c("black","blue","red","grey"))+
theme_pubclean()+
scale_x_discrete(labels=c("Phasic","Oscillator","Tonic","All"))+
ylab("Peak Input Resistance (log MOhm)")+
xlab("Firing Types" )+
theme(legend.position="none")
# Branchpoints
my.formula <- y~x
df_Morph_Clean %>%
ggplot(aes(y = number.of.dendritic.nodes,
x= DV_NLG,
color = Subtype_Precise)) +
geom_smooth(method = "lm",se = F, lwd=2)+
stat_poly_eq(formula = my.formula,
aes(label = paste(..rr.label.., sep = "~~~")),
label.x = .5,
parse = TRUE,position = "dodge") +
geom_point() +
scale_color_manual(name = "Firing Type", values = POTcolors,
labels = POTlabels)+
xlim(0,1)+ylim(0,30)+
ylab("Number of Branchpoints")+xlab("D-V Normalized Position")+
theme_pubr()+
ggtitle("Update 3-9-21: Branch Points")
# Dendritic complexity - total.dendrite.Complexity
df_Morph_Clean %>%
ggplot(aes(y = total.dendrite.Complexity,
x= DV_NLG,
color = Subtype_Precise)) +
geom_smooth(method = "lm",se = F, lwd= 2)+
stat_poly_eq(formula = my.formula,
aes(label = paste(..rr.label.., sep = "~~~")),
label.x = .5,
parse = TRUE,position = "dodge") +
geom_point() +
scale_color_manual(name = "Firing Type", values = POTcolors,
labels = POTlabels)+
xlim(0,1)+ylim(0,30000)+
ylab("Dendritic Complexity")+xlab("D-V Normalized Position")+
theme_pubr()+
ggtitle("Update 3-9-21: Dendritic Complexity")
# Mean dendritic length - total.dendrite.mean.len
df_Morph_Clean %>%
ggplot(aes(y = total.lateral.dendrite.mean.len,
x= DV_NLG,
color = Subtype_Precise)) +
geom_smooth(method = "lm",se = F, lwd = 2)+
stat_poly_eq(formula = my.formula,
aes(label = paste(..rr.label.., sep = "~~~")),
label.x = .5,
parse = TRUE,position = "dodge") +
geom_point() +
scale_color_manual(name = "Firing Type", values = POTcolors,
labels = POTlabels)+
xlim(0,1)+ylim(0,500)+
ylab("Mean Dendritic Length")+xlab("D-V Normalized Position")+
theme_pubr()+
ggtitle("Update 3-9-21: Mean LATERAL Dendritic Length")
df_Morph_Clean %>%
ggplot(aes(y = total.Medial.dendrite.mean.len,
x= DV_NLG,
color = Subtype_Precise)) +
geom_smooth(method = "lm",se = F, lwd = 2)+
stat_poly_eq(formula = my.formula,
aes(label = paste(..rr.label.., sep = "~~~")),
label.x = .5,
parse = TRUE,position = "dodge") +
geom_point() +
scale_color_manual(name = "Firing Type", values = POTcolors,
labels = POTlabels)+
xlim(0,1)+ylim(0,500)+
ylab("Mean Dendritic Length")+xlab("D-V Normalized Position")+
theme_pubr()+
ggtitle("Update 3-9-21: Mean MEDIAL Dendritic Length")
# Age Distr
df_Filter <- df_Ephys_Clean %>%
mutate(AgeBin = ifelse(Age > 28, 0, 1))
group_means <- df_Filter %>%
group_by(Subtype_Precise, AgeBin) %>%
summarise(mean = mean(Spike.Amp..Relative.Rest,na.rm = T),
sdv = sd(Spike.Amp..Relative.Rest, na.rm=T))
group_means <- group_means[-c(3,6,9),]
df_Filter <- df_Filter %>%
filter(Age > 0)
df_Filter %>%
ggplot(aes(x= Age,
y= Spike.Amp..Relative.Rest,
color = Subtype_Precise,
shape = factor(AgeBin))) +
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
# geom_boxplot(outlier.shape = NA)+
scale_shape_manual(values = c(1,16))+
stat_boxplot(geom= "errorbar", width=.6)+
geom_boxplot(width=0.6, fill="lightgrey",outlier.shape = NA)+
geom_point()+
theme_pubr()+ylab("Spike Amplitude Relative Rest")+
facet_wrap(~Subtype_Precise)
df_Filter %>%
ggplot(aes(x= Age,
y= Steady.State.Input.Resistance,
color = Subtype_Precise,
shape = factor(AgeBin))) +
stat_boxplot(geom= "errorbar", width=.6, color = "grey")+
geom_boxplot(width=0.6, fill="lightgrey",outlier.shape = NA)+
geom_point()+
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
scale_shape_manual(values = c(1,16))+
theme_pubr()+ylab("Input Resistance (log)")+
scale_y_continuous(trans="log10")+
facet_wrap(~Subtype_Precise)
df_Ephys_Clean %>%
filter(Subtype_Precise == 3) %>%
summarise(Age)
# Age Distr
df_Filter <- df_Ephys_Clean %>%
mutate(AgeBin = ifelse(Age > 28, 0, 1))
group_means <- df_Filter %>%
group_by(Subtype_Precise, AgeBin) %>%
summarise(mean = mean(Spike.Amp..Relative.Rest,na.rm = T),
sdv = sd(Spike.Amp..Relative.Rest, na.rm=T))
group_means <- group_means[-c(3,6,9),]
df_Filter <- df_Filter %>%
filter(Age > 0)
df_Filter %>%
ggplot(aes(x= Age,
y= Spike.Amp..Relative.Rest,
color = Subtype_Precise,
shape = factor(AgeBin))) +
scale_color_manual(name = "Subtype", values = POTcolors,
labels = POTlabels)+
# geom_boxplot(outlier.shape = NA)+
scale_shape_manual(values = c(1,16))+
stat_boxplot(geom= "errorbar", width=.6)+
geom_boxplot(width=0.6, fill="lightgrey",outlier.shape = NA)+
geom_point()+
theme_pubr()+ylab("Spike Amplitude Relative Rest")+
facet_wrap(~Subtype_Precise)
summary(df_Ephys_Clean$Age ~ Subtype_Precise)
summary(df_Ephys_Clean$Age)
df_Ephys_Clean %>% group_by(~Subtype_Precise) %>% summarise(Age)
df_Ephys_Clean %>% group_by(~Subtype_Precise) %>% summarise(as.numeric(Age))
df_Ephys_Clean %>%
group_by(Subtype_Precise) %>%
summarise(Age)
df_Ephys_Clean %>%
group_by(Subtype_Precise) %>%
summarise(Age) %>%
table()
df_Filter %>%
group_by(Subtype_Precise) %>%
summarise(Age) %>%
table()
str(df_Filter$Age)
df_Filter %>%
group_by(Subtype_Precise) %>%
summarise(AgeBin) %>%
table()
summary(lm(formula = EPSP.halfwidth ~ Peak.input.Resistance, data = df_Ephys_Clean))
summary(lm(formula = EPSP.halfwidth ~ Steady.State.Input.Resistance, data = df_Ephys_Clean))
summary(lm(formula = EPSP.halfwidth ~ Peak.input.Resistance, data = df_Ephys_Clean))
summary(lm(formula = EPSP.halfwidth ~ Steady.State.Input.Resistance, data = df_Ephys_Clean))
summary(lm(formula = EPSP.halfwidth ~ Peak.input.Resistance, data = df_Ephys_Clean))
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Absolute.Threshold)
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Rheobase.Current)
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Spike.Amp..Relative.Rest)
RunEffectSize(df_Ephys_Clean, Subtype_Precise, V.Rest)
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Threshold.Relative.Rest)
df_Filter %>%
group_by(Subtype_Precise) %>%
summarise(AgeBin) %>%
table()
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Resonance.Frequency)
library(esc)
library(readxl)
library(dplyr)
library(janitor)
library(ggplot2)
library(ggfortify)
library(ggpubr)
library(ggpmisc)
library("factoextra")
library(mice)
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Resonance.Frequency)
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Rheobase.Current)
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Peak.input.Resistance)
library(readxl)
library(dplyr)
library(janitor)
library(ggplot2)
library(ggfortify)
library(ggpubr)
library(ggpmisc)
library("factoextra")
library(mice)
df1 <- read_xlsx(path = "CELLS Used in Paper.xlsx")
df2 <- read_xlsx(path = "CellsForPaper_v2.xlsx")
df3 <- read_xlsx(path = "Data_Extraction_V9.xlsx")
#df <- df3[-c(1:2,419,526),]
df<- df3[-c(1:2),]
#df3_row <- df3[-c(1:2,419,526),]
df3_row <- df3[-c(1:2),]
#convert to df
df <- as.data.frame(sapply(df[,2:ncol(df)],as.numeric))
df <- cbind(df3_row[,1:2],df)
# Clean up names
colnames(df) <- make.names(colnames(df), unique=TRUE)
## Collapsing 1&1.5 into 1, 3&3.5 into 3, and everything else (2&2.5) into 2
# removing 0, 8 (?), and 9 (?)
df <- df %>%
filter(Subtype...Broad != 0) %>%
filter(Subtype...Broad != 8) %>%
filter(Subtype...Broad != 9) %>%
mutate(Subtype_Precise = as.factor(ifelse(Subtype...Broad < 2, 1,
ifelse(Subtype...Broad >= 3, 3, 2))))
# df$Subtype_Precise <- as.factor(df$Subtype_Precise)
df <- df %>%
mutate(DV_NLG = 1-(df$V.D.Norm..Position...Imprecise))
df_Prefilter <- df
df_Ephys_Clean <- df %>%
filter(is.na(Excluded_Physiology)) %>%
filter(Age > 17) %>%
filter(Cell.Name != "150720_09") # incredibly high RinSS phasic removed
### Removing from Excluded and Anatomy, and those found in Outlier analysis
df_Morph_Clean <- df %>%
filter(is.na(Excluded_Anatomy)) %>%
filter(Cell.Name != "170703_03") %>%
filter(Cell.Name != "160112_18")
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Time.Constant...Neg..step)
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Peak.input.Resistance)
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Time.Constant...Neg..step)
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Absolute.Threshold)
RunEffectSize(df_Ephys_Clean, Subtype_Precise, V.Rest)
RunEffectSize(df_Ephys_Clean, Subtype_Precise, Threshold.Relative.Rest)
